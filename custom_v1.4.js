var isMobile=!1;function initialize(){reset_timer(),session_restore(),load_puzzle(),generate_scramble()}function pushbutton(){timer.running()?stop_timer():(1*session_get("insp_time")&&(inspection_running=!0),start_timer())}function start_timer(){reset_timer(),timer.start(),show_time()}function stop_timer(){timer.stop(),clearTimeout(timer.timer_id),inspection_running||add_time(timer.elapsed()),show_time(),refresh_stats(),generate_scramble(),inspection_running=!1}function refresh_stats(){new_html="",new_html+='<div style="height: 192px; overflow: auto; padding: 5px; border: 1px solid #89c; background: #fff;">';var e=0,t=0,s=0,n=0,a=0,l=0,o=0,m=0,r=0,_="x",c="x";if(time_list.length>0){for(new_html+='<table cellpadding="0" cellspacing="0">',i=time_list.length-1,count=0;i>=0;i--,count++)new_html+="<tr>",new_html+='<td align="right"><strong><em>'+(i+1)+":</em></strong></td>",new_html+='<td style="padding: 0 20px;">'+format_time(time_list[i])+"</td>",new_html+='<td><a href="javascript:remove_time('+i+')">x</a></td>',e+=1*time_list[i],count<5&&(t+=1*time_list[i]),count<10&&(s+=1*time_list[i]),count<20&&(n+=1*time_list[i]),count<30&&(a+=1*time_list[i]),count<40&&(l+=1*time_list[i]),count<50&&(o+=1*time_list[i]),count<75&&(m+=1*time_list[i]),count<100&&(r+=1*time_list[i]),("x"==_||1*time_list[i]<_)&&(_=1*time_list[i]),("x"==c||1*time_list[i]>c)&&(c=1*time_list[i]),new_html+="</tr>";new_html+="</table>"}new_html+="</div>",document.getElementById("times").innerHTML=new_html;var d=new Array;for(i in d.stat_avg=time_list.length>=1?format_time(e/time_list.length):"--:--.--",d.stat_avg5=time_list.length>=5?format_time(t/5):d.stat_avg,d.stat_avg10=time_list.length>=10?format_time(s/10):d.stat_avg,d.stat_avg20=time_list.length>=20?format_time(n/20):d.stat_avg,d.stat_avg30=time_list.length>=30?format_time(a/30):d.stat_avg,d.stat_avg40=time_list.length>=40?format_time(l/40):d.stat_avg,d.stat_avg50=time_list.length>=50?format_time(o/50):d.stat_avg,d.stat_avg75=time_list.length>=75?format_time(m/75):d.stat_avg,d.stat_avg100=time_list.length>=100?format_time(r/100):d.stat_avg,d.stat_best=time_list.length>=1?format_time(_):"--:--.--",d.stat_worst=time_list.length>=1?format_time(c):"--:--.--",d)document.getElementById(i)&&(document.getElementById(i).innerHTML=d[i]);new_html="",document.getElementById("avg").innerHTML=new_html}function show_time(){inspection_running?(seconds_left=Math.round((1e3*session_get("insp_time")-timer.elapsed())/1e3),seconds_left>0?(document.getElementById("elapsed_time").innerHTML=seconds_left,seconds_left<=3&&session_get("insp_sound")&&soundManager.play("beep"),timer.running()&&(timer.timer_id=setTimeout("show_time()",500))):(timer.stop(),reset_timer(),timer.start(),session_get("insp_sound")&&soundManager.play("pop"),inspection_running=!1,document.getElementById("elapsed_time").innerHTML=format_time(0).replace(".",":"),timer.running()&&(timer.timer_id=setTimeout("show_time()",15)))):(document.getElementById("elapsed_time").innerHTML=format_time(timer.elapsed()).replace(".",":"),timer.running()&&(timer.timer_id=setTimeout("show_time()",15)))}function format_time(e){return e*=1,timer.time_segments[0]=lpad(Math.floor(e/6e4),2,"0"),e%=6e4,timer.time_segments[1]=lpad(Math.floor(e/1e3),2,"0"),e%=1e3,timer.time_segments[2]=lpad(Math.floor(e/10),2,"0",!0),timer.time_segments[0]+":"+timer.time_segments[1]+"."+timer.time_segments[2]}function reset_timer(){if(!timer.running()){for(var e=0;e<timer.time_segments.length;e++)timer.time_segments[e]="00";timer.reset(),show_time()}}function lpad(e,t,i,s){for(e+="",i=i||" ";e.length<t;)e=i+e;return s&&e.length>t?e.substr(0,t):e}function add_time(e){time_list[time_list.length]=e,save_time(e,selected_puzzle),session_save()}function remove_time(e){time_list.splice(e,1),refresh_stats(),session_save()}function clear_times(){time_list.length&&confirm("Are you sure ?\nYou want to clear the time?")&&(eval("time_list = time_list_"+selected_puzzle+" = new Array();"),refresh_stats(),session_save(),$("#elapsed_time").text("00:00:00"))}function switch_puzzles(){var e='<select style="width: 190px;" onchange="selected_puzzle = options[selectedIndex].value; load_puzzle();">';for(var t in puzzle_names)e+='<option value="'+t+'"'+(t==selected_puzzle?' selected="selected"':"")+">"+puzzle_names[t]+"</option>";e+="</select>",e+=' <a href="javascript:cancel_switch_puzzles()" style="font-size: 10px;">cancel</a>',document.getElementById("puzzle_selector").innerHTML=e}function cancel_switch_puzzles(){document.getElementById("puzzle_selector").innerHTML='<h3 style="margin: 0;">'+puzzle_names[selected_puzzle]+"</h3>"}function load_puzzle(){eval("time_list = time_list_"+selected_puzzle+";"),document.getElementById("puzzle_selector").innerHTML='<h3 style="margin: 0;">'+puzzle_names[selected_puzzle]+"</h3>",refresh_stats(),session_save();var scramble_supported=["222","222bf","333","333bf","333oh","333ft","444","444bf","555","555bf"];for(i in scramble_is_supported=!1,scramble_supported)if(selected_puzzle==scramble_supported[i]){scramble_is_supported=!0;break}generate_scramble(),document.getElementById("scramble").style.display=scramble_is_supported?"":"none"}function session_save(){for(i in puzzle_names)eval("params['time_list_"+i+"'] = time_list_"+i+".join(',');");params.selected_puzzle=selected_puzzle,setCookie("kbcube",params.toString(),720)}function session_get(e){return params[e]}function session_set(e,t){params[e]=t,session_save()}function session_unset(e){delete params[e]}function session_restore(){var cookie=readCookie("kbcube");if(cookie){for(i in params=new ParamString(cookie),params.time_list&&(time_list_333=params.time_list.split(",")),puzzle_names)params["time_list_"+i]?eval("time_list_"+i+" = params['time_list_"+i+"'].split(',');"):333!=i&&eval("time_list_"+i+" = new Array();");params.selected_puzzle&&(selected_puzzle=params.selected_puzzle),document.settings_form.insp_time.value=session_get("insp_time")?session_get("insp_time"):"0",document.settings_form.insp_sound.checked=!!session_get("insp_sound")}}function save_settings(){session_set("insp_time",document.settings_form.insp_time.value),session_set("insp_sound",document.settings_form.insp_sound.checked?"1":"")}function show_info(){$("#short_info").hide("fast"),$("#full_info").slideDown("slow")}function hide_info(){$("#full_info").slideUp("fast"),$("#short_info").slideDown("fast")}function avg_with_discards(e,t){for(var i in t&&(e=e.slice(-t)),highest=lowest=null,total=0,e)time=1*e[i],(null==lowest||time<lowest)&&(lowest=time),(null==highest||time>highest)&&(highest=time),total+=time;return total-=lowest+highest,count=(t||e.length)-2,total/count}function save_time(e,t){var i=new Array;i.seconds=e/1e3,i.puzzle=t,ajax_call("timelog_insert","timelog_insert_cb",i)}function timelog_insert_cb(e){return!0}function Scramble(e,t){switch(this.puzzle=e||333,e){case"444":case"444bf":case"555":case"555bf":this.turns=t||(0==e.indexOf("444")?40:60),this.faces={R:{allowed:!0,enables:["U","Uw","D","Dw","F","Fw","B","Bw"]},Rw:{allowed:!0,enables:["U","Uw","D","Dw","F","Fw","B","Bw"]},L:{allowed:!0,enables:["U","Uw","D","Dw","F","Fw","B","Bw"]},Lw:{allowed:!0,enables:["U","Uw","D","Dw","F","Fw","B","Bw"]},U:{allowed:!0,enables:["R","Rw","L","Lw","F","Fw","B","Bw"]},Uw:{allowed:!0,enables:["R","Rw","L","Lw","F","Fw","B","Bw"]},D:{allowed:!0,enables:["R","Rw","L","Lw","F","Fw","B","Bw"]},Dw:{allowed:!0,enables:["R","Rw","L","Lw","F","Fw","B","Bw"]},F:{allowed:!0,enables:["R","Rw","L","Lw","U","Uw","D","Dw"]},Fw:{allowed:!0,enables:["R","Rw","L","Lw","U","Uw","D","Dw"]},B:{allowed:!0,enables:["R","Rw","L","Lw","U","Uw","D","Dw"]},Bw:{allowed:!0,enables:["R","Rw","L","Lw","U","Uw","D","Dw"]}},this.face_index=["R","Rw","L","Lw","U","Uw","D","Dw","F","Fw","B","Bw"];break;case"222":case"222bf":case"333":case"333bf":case"333oh":case"333ft":default:this.turns=t||25,this.faces={R:{allowed:!0,enables:["U","D","F","B"]},L:{allowed:!0,enables:["U","D","F","B"]},U:{allowed:!0,enables:["R","L","F","B"]},D:{allowed:!0,enables:["R","L","F","B"]},F:{allowed:!0,enables:["R","L","U","D"]},B:{allowed:!0,enables:["R","L","U","D"]}},this.face_index=["R","L","U","D","F","B"]}this.scramble=[],this.generate()}function Scramble_generate(){for(this.scramble=[],i=0;i<this.turns;i++){do{rand=Math.floor(Math.random()*this.face_index.length),face=this.face_index[rand]}while(!this.faces[face].allowed);for(this.faces[face].allowed=!1,f=0;f<this.faces[face].enables.length;f++)this.faces[this.faces[face].enables[f]].allowed=!0;switch(Math.floor(3*Math.random())){case 0:direction="";break;case 1:direction="'";break;case 2:direction="2"}this.scramble[i]=face+direction}}function Scramble_toString(){return this.scramble.join(" ")}function get_scramble(e,t){return new Scramble(e=e||selected_puzzle,t).toString()}function generate_scramble(){s=get_scramble(),s=s.replace(/ /g," &nbsp;"),document.getElementById("scramble").innerHTML="Scramble:&nbsp;&nbsp;"+s}(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)))&&(isMobile=!0),Scramble.prototype.generate=Scramble_generate,Scramble.prototype.toString=Scramble_toString;var timer=new StopWatch;timer.time_segments=new Array,timer.timer_id=0,time_list=new Array,inspection_running=!1,params=new ParamString("");var puzzle_names={222:"2x2x2 Cube",333:"Saiprateeth Rubik's Cube",444:"4x4x4 Cube",555:"5x5x5 Cube",666:"6x6x6 Cube",777:"7x7x7 Cube",888:"8x8x8 Cube",999:"9x9x9 Cube","10cube":"10x10x10 Cube","11cube":"11x11x11 Cube","333bf":"3x3x3 Blindfolded","333oh":"3x3x3 One-Handed","333ft":"3x3x3 With Feet",magic:"Rubik's Magic",mmagic:"Rubik's Master Magic",minx:"Megaminx",pyram:"Pyraminx",sq1:"Square-1",skewb:"Skewb",gear:"Gear Cube",clock:"Rubik's Clock","222bf":"2x2x2 Blindfolded","444bf":"4x4x4 Blindfolded","555bf":"5x5x5 Blindfolded",siam:"Siamese Cube",oth1:'"Other" #1',oth2:'"Other" #2',oth3:'"Other" #3',oth4:'"Other" #4',oth5:'"Other" #5'};for(i in puzzle_names)eval("time_list_"+i+" = new Array();");selected_puzzle=333,$("div.dropdown-menu > a").click(function(){$(".navbar-toggler").addClass("collapsed").attr("aria-expanded",!1),$(".navbar-collapse").removeClass("show")});